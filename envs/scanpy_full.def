Bootstrap: docker
From: python:3.12.9-slim

%labels
    Author "Aidan Meara"
    Version "1.0"
    Description "Def for sif for running omnibenchmarkized version of scanpy in https://github.com/billila/pca_scwf_paper"

%post
    # Update and install system dependencies
    apt-get update && apt-get install -y \
        gcc \
        g++ \
        gfortran \
        cmake \
        make \
        git \
        libhdf5-dev \
        libopenblas-dev \
        libigraph-dev \
        libxml2-dev \
        libglpk-dev \
        libgmp-dev \
        pkg-config \
        git-all \
        && rm -rf /var/lib/apt/lists/*

    # Upgrade pip only
    pip install --no-cache-dir --upgrade pip

    # Pinning everything to match conda environment exactly
    # Note: Some conda packages are renamed or not needed on PyPI
    pip install --no-cache-dir \
        setuptools==75.8.2 \
        wheel==0.45.1 \
        pip==25.0.1 \
        six==1.17.0 \
        packaging==24.2 \
        pyparsing==3.2.1 \
        python-dateutil==2.9.0.post0 \
        pytz==2024.1 \
        tzdata \
        colorama==0.4.6 \
        exceptiongroup==1.2.2 \
        cached-property==1.5.2 \
        array-api-compat==1.11 \
        numpy==2.1.3 \
        llvmlite==0.44.0 \
        numba==0.61.0 \
        scipy==1.15.2 \
        pandas==2.2.3 \
        threadpoolctl==3.5.0 \
        joblib==1.4.2 \
        scikit-learn==1.6.1 \
        contourpy==1.3.1 \
        cycler==0.12.1 \
        fonttools==4.56.0 \
        kiwisolver==1.4.8 \
        munkres==1.1.4 \
        pillow==11.1.0 \
        matplotlib==3.10.1 \
        seaborn==0.13.2 \
        h5py==3.13.0 \
        natsort==8.4.0 \
        networkx==3.4.2 \
        pynndescent==0.5.13 \
        umap-learn==0.5.7 \
        texttable==1.7.0 \
        python-igraph==0.11.8 \
        leidenalg==0.10.2 \
        louvain==0.8.2 \
        patsy==1.0.1 \
        statsmodels==0.14.4 \
        tqdm==4.67.1 \
        anndata==0.11.3 \
        openpyxl==3.1.5 \
        et_xmlfile==2.0.0 \
        session-info==1.0.0 \
        stdlib-list==0.11.1 \
        legacy-api-wrap==1.4.1 \
        unicodedata2==16.0.0 \
        scanpy==1.10.4

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8

%runscript
    exec python "$@"
